---
interface Props {
  toolName: string;
  toolSlug?: string;
  variant?: 'default' | 'urgency' | 'value' | 'social';
  benefit?: string;
  dealText?: string;
}

const { 
  toolName, 
  toolSlug = toolName.toLowerCase().replace(/\s+/g, '-'),
  variant = 'default',
  benefit,
  dealText
} = Astro.props;

const ctaTexts = {
  default: `Try ${toolName}`,
  urgency: `Limited Time: Try ${toolName}`,
  value: `Start with ${toolName} Free`,
  social: `Join Thousands Using ${toolName}`,
};
---

<div class="inline-cta my-8 p-6 rounded-sm bg-gradient-to-r from-brand/10 to-purple-500/10 border-2 border-brand/30 hover:border-brand/50 transition-all">
  <div class="flex flex-col md:flex-row items-center justify-between gap-4">
    <div class="flex-1">
      <h4 class="text-lg font-bold text-white mb-1">{ctaTexts[variant]}</h4>
      {benefit && (
        <p class="text-sm text-slate-300">{benefit}</p>
      )}
      {dealText && (
        <div class="mt-2 inline-flex items-center gap-2 px-3 py-1 bg-green-500/20 border border-green-500/40 rounded-full">
          <span class="text-xs font-semibold text-green-400">ðŸ’° {dealText}</span>
        </div>
      )}
    </div>
    
    <a
      href={`#${toolSlug}-affiliate`}
      class="inline-flex items-center gap-2 px-6 py-3 bg-brand hover:bg-brand/80 text-white font-semibold rounded-sm transition-all transform hover:scale-105 shadow-lg hover:shadow-brand/50"
      data-affiliate="true"
      data-tool={toolName}
      data-link-type="inline"
    >
      <span>Get Started</span>
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
      </svg>
    </a>
  </div>
</div>

<script>
  document.querySelectorAll('.inline-cta a[data-affiliate="true"]').forEach(link => {
    link.addEventListener('click', (e) => {
      e.preventDefault();
      const toolName = link.getAttribute('data-tool');
      
      if (typeof gtag !== 'undefined') {
        gtag('event', 'affiliate_click', {
          tool_name: toolName,
          link_type: 'inline',
          position: 'mid-content',
        });
      }
      
      const target = document.querySelector('[data-affiliate="true"][data-tool="' + toolName + '"]');
      if (target) {
        target.scrollIntoView({ behavior: 'smooth', block: 'center' });
        setTimeout(() => {
          (target as HTMLElement).click();
        }, 500);
      }
    });
  });
</script>
