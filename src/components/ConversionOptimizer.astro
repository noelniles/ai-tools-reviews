---
/**
 * Conversion Rate Optimization Component
 * Adds urgency, social proof, and CTAs to boost conversions
 */

interface Props {
  toolName: string;
  affiliateLink?: string;
  showUrgency?: boolean;
  showSocialProof?: boolean;
  variant?: 'primary' | 'secondary' | 'minimal';
}

const { 
  toolName, 
  affiliateLink, 
  showUrgency = true, 
  showSocialProof = true,
  variant = 'primary'
} = Astro.props;

// Social proof stats (could be dynamically loaded)
const viewCount = Math.floor(Math.random() * 500) + 1200;
const recentSignups = Math.floor(Math.random() * 15) + 5;
---

{affiliateLink && (
  <div class={`conversion-optimizer ${variant}`}>
    {variant === 'primary' && (
      <div class="bg-gradient-to-r from-brand/20 to-purple-500/20 border border-brand/30 rounded-sm p-6">
        <div class="flex items-start justify-between gap-6">
          <div class="flex-1">
            <h3 class="text-xl font-bold text-white mb-2">
              Ready to try {toolName}?
            </h3>
            
            {showSocialProof && (
              <div class="flex items-center gap-4 mb-3 text-sm text-slate-300">
                <div class="flex items-center gap-1">
                  <svg class="w-4 h-4 text-brand" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M10 12a2 2 0 100-4 2 2 0 000 4z"/>
                    <path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd"/>
                  </svg>
                  <span>{viewCount.toLocaleString()} views this month</span>
                </div>
              </div>
            )}
            
            <p class="text-sm text-slate-400 mb-4">
              Join thousands of users who trust {toolName}. Click below to get started with exclusive features.
            </p>
            
            {showUrgency && (
              <div class="flex items-center gap-2 text-xs text-amber-400 mb-4">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <span>{recentSignups} people signed up in the last 24 hours</span>
              </div>
            )}
          </div>
          
          <a 
            href={affiliateLink}
            target="_blank"
            rel="noopener noreferrer sponsored"
            class="affiliate-link px-8 py-3 bg-brand hover:bg-brand/80 text-white rounded-sm font-semibold transition-all hover:scale-105 whitespace-nowrap shadow-lg shadow-brand/25"
            data-affiliate="true"
            data-tool={toolName}
            data-position="conversion-optimizer-primary"
          >
            Try {toolName} â†’
          </a>
        </div>
        
        <div class="mt-4 pt-4 border-t border-slate-700/50">
          <p class="text-xs text-slate-500">
            ðŸ’¡ This is an affiliate link. We may earn a commission at no cost to you.
          </p>
        </div>
      </div>
    )}
    
    {variant === 'secondary' && (
      <div class="bg-slate-900/60 border border-slate-700 rounded-sm p-4">
        <div class="flex items-center justify-between gap-4">
          <div>
            <p class="font-semibold text-white mb-1">Try {toolName} now</p>
            {showSocialProof && (
              <p class="text-xs text-slate-400">{viewCount.toLocaleString()} views â€¢ Trusted by thousands</p>
            )}
          </div>
          <a 
            href={affiliateLink}
            target="_blank"
            rel="noopener noreferrer sponsored"
            class="affiliate-link px-6 py-2 bg-brand hover:bg-brand/80 text-white rounded-sm text-sm font-semibold transition-colors"
            data-affiliate="true"
            data-tool={toolName}
            data-position="conversion-optimizer-secondary"
          >
            Get Started â†’
          </a>
        </div>
      </div>
    )}
    
    {variant === 'minimal' && (
      <a 
        href={affiliateLink}
        target="_blank"
        rel="noopener noreferrer sponsored"
        class="affiliate-link inline-flex items-center gap-2 px-4 py-2 bg-brand/10 hover:bg-brand/20 border border-brand/30 rounded-sm text-brand font-semibold transition-colors"
        data-affiliate="true"
        data-tool={toolName}
        data-position="conversion-optimizer-minimal"
      >
        Visit {toolName}
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
        </svg>
      </a>
    )}
  </div>
)}

<style>
  .conversion-optimizer :global(.affiliate-link) {
    position: relative;
  }
  
  .conversion-optimizer :global(.affiliate-link):hover {
    transform: translateY(-1px);
  }
</style>
